# Apache Virtual Host 配置示例
# 保存为 /etc/apache2/sites-available/llm-context-builder.conf

<VirtualHost *:80>
    ServerName your-domain.com
    ServerAlias www.your-domain.com
    DocumentRoot /var/www/html/llm-context-builder
    
    # 启用必需的模块
    RewriteEngine On
    
    # React Router 支持
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -f [OR]
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -d
    RewriteRule ^ - [L]
    RewriteRule ^ /index.html [L]
    
    # 安全头部
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "no-referrer-when-downgrade"
    Header always set X-XSS-Protection "1; mode=block"
    
    # 缓存配置
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 year"
        Header append Cache-Control "public, immutable"
    </LocationMatch>
    
    # 目录权限
    <Directory /var/www/html/llm-context-builder>
        AllowOverride All
        Require all granted
        Options -Indexes
    </Directory>
    
    # 日志
    ErrorLog ${APACHE_LOG_DIR}/llm-context-builder_error.log
    CustomLog ${APACHE_LOG_DIR}/llm-context-builder_access.log combined
</VirtualHost>

# HTTPS 配置 (推荐配置 SSL)
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName your-domain.com
    ServerAlias www.your-domain.com
    DocumentRoot /var/www/html/llm-context-builder
    
    # SSL 配置
    SSLEngine on
    SSLCertificateFile /path/to/your/certificate.crt
    SSLCertificateKeyFile /path/to/your/private.key
    # SSLCertificateChainFile /path/to/your/chain.crt
    
    # 其他配置与 HTTP 版本相同...
    RewriteEngine On
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -f [OR]
    RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -d
    RewriteRule ^ - [L]
    RewriteRule ^ /index.html [L]
    
    <Directory /var/www/html/llm-context-builder>
        AllowOverride All
        Require all granted
        Options -Indexes
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/llm-context-builder_ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/llm-context-builder_ssl_access.log combined
</VirtualHost>
</IfModule>